# 产品需求文档 (PRD)

## 1. 项目概述

开发一个基于fastmcp的MCP（微控制程序），用于将传入的JSON格式的Markdown内容转换为交互式闪卡页面。用户可以通过调用此MCP服务，将结构化的Markdown内容快速转换为美观、实用的闪卡应用。

## 2. 技术栈

- 核心框架：fastmcp
- 包管理：uv
- 语言：Python
- 输出格式：HTML/CSS/JavaScript

## 3. 功能需求

### 3.1 核心功能

- **JSON解析功能**：接收并解析符合特定格式的JSON数据，提取Markdown内容和元数据
- **Markdown转换功能**：将Markdown内容转换为HTML格式
- **闪卡生成功能**：根据转换后的HTML内容生成交互式闪卡页面
- **样式应用功能**：应用预设样式或用户自定义样式到闪卡页面
- **模板选择功能**：支持用户通过模板名称选择预设样式模板，默认为"default"模板

### 3.2 辅助功能

- **错误处理**：对无效的JSON格式、不支持的Markdown语法等情况进行优雅处理
- **日志记录**：记录关键操作和错误信息
- **性能监控**：监控转换过程的性能指标

## 4. JSON格式规范

输入的JSON数据应遵循以下格式：

```json
{
  "metadata": {
    "title": "闪卡集标题",
    "description": "闪卡集描述",
    "version": "1.0.0",
    "created_at": "2024-01-01T12:00:00Z"
  },
  "cards": [
    {
      "id": "card-1",
      "front": "正面内容（Markdown格式）",
      "back": "背面内容（Markdown格式）",
      "tags": ["标签1", "标签2"]
    },
    {
      "id": "card-2",
      "front": "正面内容（Markdown格式）",
      "back": "背面内容（Markdown格式）",
      "tags": ["标签3", "标签4"]
    }
    // 更多闪卡...
  ],
  "style": {
    "template": "default", // 模板名称，默认为"default"
    "theme": "light", // light, dark, custom
    "colors": {
      "primary": "#007bff",
      "secondary": "#6c757d"
    },
    "font": "Arial, sans-serif"
  }
}
```

## 5. 系统架构

### 5.1 模块划分

1. **输入处理模块**：负责接收和验证JSON数据
2. **解析转换模块**：负责解析JSON和转换Markdown内容
3. **闪卡生成模块**：负责生成闪卡HTML结构
4. **样式应用模块**：负责应用样式到闪卡页面
5. **输出处理模块**：负责输出最终的HTML页面

### 5.2 数据流

1. 用户传入JSON格式的Markdown内容
2. 系统解析JSON数据，提取元数据和闪卡内容
3. 将Markdown格式的闪卡内容转换为HTML
4. 根据解析的内容和样式配置生成完整的闪卡页面
5. 将生成的HTML页面作为响应返回给用户

## 6. 接口设计

### 6.1 API端点

- **POST /convert**
  - 功能：接收JSON格式的Markdown内容，返回生成的闪卡HTML页面
  - 请求体：符合规范的JSON数据
  - 响应：生成的HTML页面内容
  - 状态码：
    - 200：成功
    - 400：无效的JSON格式或内容
    - 500：服务器内部错误

## 7. 性能要求

- 响应时间：对于包含100张以内闪卡的请求，响应时间应小于2秒
- 并发处理：能够同时处理至少10个并发请求

## 8. 部署要求

- 使用uv进行包管理和环境配置
- 提供Docker容器化支持，便于部署和扩展
- 支持配置环境变量进行参数调整

## 9. 测试要求

- 单元测试：覆盖核心功能模块
- 集成测试：测试整个转换流程
- 性能测试：验证在高负载情况下的系统表现

## 10. 文档要求

- 提供API文档
- 提供部署和配置文档
- 提供使用示例和最佳实践

## 11. 后续可能的扩展功能

- 支持更多Markdown扩展语法
- 提供更多闪卡交互模式
- 提供闪卡学习进度跟踪功能
- 添加导出功能，支持导出为PDF或其他格式